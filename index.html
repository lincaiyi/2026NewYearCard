<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>2026 丙午歲次賀禮集</title>

<style>
:root{
  --env-red:#9e0b0f;
  --env-dark:#5e0505;
  --gold-main:linear-gradient(135deg,#bf953f,#fcf6ba,#b38728,#fbf5b7,#aa771c);
  --gold-text:linear-gradient(to right,#bf953f 22%,#fcf6ba 45%,#b38728 50%,#fcf6ba 55%,#bf953f 78%);
}

body{
  margin:0;height:100vh;display:flex;align-items:center;justify-content:center;
  background:#050505;perspective:2000px;font-family:"Noto Serif TC",serif;
  overflow:hidden;
}
body::before{
  content:'';position:absolute;inset:0;
  background:radial-gradient(circle at center,#2c0000 0%,#000 70%);
  z-index:-1;
}

/* 調整容器為響應式寬度，最大不超過 420px */
#container{position:relative;width:90vw;max-width:420px;height:300px;margin:0 auto}

.card-system{
  position:absolute;width:100%;height:100%;cursor:pointer;
  transition:.8s cubic-bezier(.34,1.56,.64,1);
  visibility:hidden;opacity:0;
  transform:translateY(100px) scale(.8);
  --x:50%;--y:50%;
  left:0;top:0;
}
.card-system.active{
  visibility:visible;opacity:1;transform:none;z-index:100;
}
.card-system.exit-up{opacity:0;transform:translateY(-800px) rotate(-10deg) scale(1.1)}
.card-system.queue-down{opacity:0;transform:translateY(400px) scale(.85)}

.card-system::after{
  content:'';position:absolute;inset:-30px;
  background:radial-gradient(300px circle at var(--x) var(--y),
    rgba(255,215,150,.22),
    rgba(255,215,150,.08) 35%,
    transparent 60%);
  opacity:0;transition:.4s;pointer-events:none;
}
.card-system.active::after{opacity:1}

/* Envelope */
.envelope-back{position:absolute;inset:0;background:var(--env-dark);border-radius:4px;box-shadow:0 30px 60px rgba(0,0,0,.8)}
.envelope-front{position:absolute;inset:0;background:var(--env-red);
clip-path:polygon(0 35%,50% 70%,100% 35%,100% 100%,0 100%);z-index:10}
.envelope-front::after{
  content:'';position:absolute;inset:0;background:var(--gold-main);
  clip-path:polygon(0 35%,50% 70%,100% 35%,100% 37%,50% 72%,0 37%)
}

.lid{position:absolute;inset:0;transform-origin:top;transition:.6s ease;z-index:15}
.lid::before{
  content:'';position:absolute;
  /* 使用百分比確保手機版三角形正確對齊 */
  border-left:45vw solid transparent;
  border-right:45vw solid transparent;
}
/* 針對大螢幕限制三角形寬度 */
@media(min-width:467px){
  .lid::before{
    border-left:210px solid transparent;
    border-right:210px solid transparent;
  }
}
.lid::before{
  border-top:160px solid #7a0000;
  left:50%;transform:translateX(-50%);
}

.seal{
  position:absolute;top:120px;left:50%;transform:translateX(-50%);
  width:65px;height:65px;border-radius:50%;
  background:var(--gold-main);
  display:flex;align-items:center;justify-content:center;
  font-size:28px;font-weight:bold;color:#5a0000;
  box-shadow:0 6px 15px rgba(0,0,0,.4);z-index:20;
}

/* Letter */
.letter{
  position:absolute;bottom:5px;left:50%;transform:translateX(-50%);
  width:94%;height:260px;padding:20px;box-sizing:border-box;
  background:#fffdf5 url('https://www.transparenttextures.com/patterns/paper-fibers.png');
  border:1px solid #e0d5b0;border-radius:2px;
  clip-path:inset(100% 0 0 0);
  transition:.7s cubic-bezier(.4,0,.2,1);
  z-index:5;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
}

/* 三段式 */
.card-system.break-seal .seal{animation:sealBreak .5s ease forwards}
@keyframes sealBreak{
  0%{transform:translateX(-50%) scale(1)}
  60%{transform:translateX(-50%) scale(1.2)}
  100%{transform:translateX(-50%) scale(0);opacity:0}
}
.card-system.open-lid .lid{transform:rotateX(160deg);z-index:1}
.card-system.pull-letter .letter{
  transform:translateX(-50%) translateY(-220px);
  clip-path:inset(0 0 0 0);
  box-shadow:0 20px 40px rgba(0,0,0,.6);
}

/* Text */
.title{
  margin:0;font-size:22px;letter-spacing:4px;font-weight:900;
  background:var(--gold-text);background-size:200% auto;
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  animation:shine 3s linear infinite;
  text-align:center;
}
@keyframes shine{to{background-position:200% center}}

.text{margin-top:15px;text-align:center;line-height:1.7;color:#444;font-size:16px}

.line{
  opacity:0;transform:translateY(6px);
  animation:lineIn .6s ease forwards;
}
@keyframes lineIn{to{opacity:1;transform:none}}

.signature{
  margin-top:15px;
  align-self:flex-end;
  font-weight:bold;
  color:#8b0000;
  font-size:14px;
}

.letter-deco{width:80%;height:1px;background:var(--gold-main);margin:12px 0;opacity:.5}

.counter{position:fixed;top:20px;right:20px;color:#bf953f;font-size:14px;z-index:200}
.hint{position:fixed;bottom:30px;width:100%;text-align:center;color:#bf953f;letter-spacing:4px;font-size:14px;z-index:200}
</style>
</head>

<body>
<div class="counter" id="counter"></div>
<div id="container"></div>
<div class="hint">✦ 滑動切換 · 點擊拆封 ✦</div>

<script>
const wishes=[
 {to:"國王 女王 大王",from:"王大明",wish:["祝您新的一年","龍馬精神，步步高升。"]},
 {to:"尊貴貴賓",from:"李小華",wish:["願 2026 丙午年","身體康健，萬事順遂。"]},
 {to:"敬愛的您",from:"張經理",wish:["感謝一路支持","財源廣進，福氣滿門。"]}
];

let currentIndex=0;
const container=document.getElementById("container");
const counter=document.getElementById("counter");

/* 極輕紙張音效 */
const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
function paperSound(){
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.type="triangle";o.frequency.value=180;
  g.gain.value=0.015;
  o.connect(g);g.connect(audioCtx.destination);
  o.start();o.stop(audioCtx.currentTime+.08);
}

function updateView(){
 document.querySelectorAll(".card-system").forEach((c,i)=>{
  c.className="card-system";
  if(i===currentIndex)c.classList.add("active");
  else if(i<currentIndex)c.classList.add("exit-up");
  else c.classList.add("queue-down");
 });
 counter.innerText=`Nº ${currentIndex+1} / ${wishes.length}`;
}

function initCards(){
 wishes.forEach(item=>{
  const card=document.createElement("div");
  card.className="card-system";
  card.dataset.step=0;

  const lines=item.wish.map(
    (t,i)=>`<div class="line" style="animation-delay:${i*.25}s">${t}</div>`
  ).join("");

  card.innerHTML=`
    <div class="lid"></div>
    <div class="seal">賀</div>
    <div class="envelope-back"></div>
    <div class="envelope-front"></div>
    <div class="letter">
     <h1 class="title">祝賀 ${item.to}</h1>
     <div class="letter-deco"></div>
     <div class="text">${lines}</div>
     <div class="signature">${item.from} 敬賀</div>
    </div>`;

  card.onclick=()=>{
    if(!card.classList.contains("active"))return;
    const step=+card.dataset.step;
    if(step===0)card.classList.add("break-seal");
    if(step===1)card.classList.add("open-lid");
    if(step===2){card.classList.add("pull-letter");paperSound();}
    card.dataset.step=Math.min(step+1,3);
  };
  container.appendChild(card);
 });
 updateView();
}

function reset(card){
 card.classList.remove("break-seal","open-lid","pull-letter");
 card.dataset.step=0;
}

function change(dir){
 const active=document.querySelector(".active");
 if(active)reset(active);
 if(dir==="next"&&currentIndex<wishes.length-1)currentIndex++;
 if(dir==="prev"&&currentIndex>0)currentIndex--;
 updateView();
}

window.addEventListener("wheel",e=>{
 if(Math.abs(e.deltaY)>30)change(e.deltaY>0?"next":"prev");
});

let t=0;
window.addEventListener("touchstart",e=>t=e.touches[0].clientY);
window.addEventListener("touchend",e=>{
 const d=t-e.changedTouches[0].clientY;
 if(Math.abs(d)>50)change(d>0?"next":"prev");
});

container.addEventListener("mousemove",e=>{
 const c=document.querySelector(".active");
 if(!c)return;
 const r=c.getBoundingClientRect();
 c.style.setProperty("--x",`${e.clientX-r.left}px`);
 c.style.setProperty("--y",`${e.clientY-r.top}px`);
});

initCards();
</script>
</body>
</html>
